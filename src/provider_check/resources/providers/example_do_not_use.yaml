---
# Example provider configuration with all supported fields.
# This file is disabled by default and is meant purely for documentation.
# It will NOT appear in --providers-list and cannot be selected unless
# you copy it into a custom provider directory and set enabled: true.

enabled: false
# Optional inheritance. Use a provider id or list of ids; [] means no inheritance.
extends: []
name: Example Provider (DO NOT USE)
version: 1
short_description: "Optional short summary of the provider (keep under 150 chars)."
long_description: |
  Optional long-form description of the provider. Use multiple lines to
  explain what the configuration is intended for and any key assumptions.

variables:
  # Provider variables can be referenced using {name} placeholders.
  # Values are provided via --provider-var name=value (repeatable).
  # {domain} is always available and {selector} is reserved for DKIM templates.
  tenant:
    required: true
    description: "Example required variable used in record templates."
  region:
    default: us
    description: "Optional region short code used in record templates."

records:
  # Record sections are ordered for readability; order has no functional effect.
  # Use trailing dots for fully-qualified names; omit for names relative to the checked domain.
  # required values must be present; optional values warn if missing.
  mx:
    # Required MX host/priority pairs.
    required:
      - host: mx1.{tenant}.example-provider.test.
        priority: 10
      - host: mx2.{tenant}.example-provider.test.
        priority: 20
      - host: mx3.{tenant}.example-provider.test.
        priority: 30
    # Optional MX host/priority pairs.
    optional:
      - host: mx4.{tenant}.example-provider.test.
        priority: 40

  spf:
    # Required SPF values.
    required:
      # Required SPF terminator policy:
      # hardfail=-all, softfail=~all, neutral=?all, allow=+all.
      policy: hardfail
      # Include mechanisms the provider requires (values only).
      includes:
        - spf.{tenant}.example-provider.test
        - "{tenant}.example-provider.test"
      # Additional mechanisms that must be present.
      # Include full tokens (e.g., a, mx:mail.example-provider.test, exists:%{i}.spf.example-provider.test).
      mechanisms:
        - a
        - mx:mail.{tenant}.example-provider.test
        - exists:%{i}.spf.{tenant}.example-provider.test
      # Modifiers that must be present with exact values.
      modifiers:
        exp: exp._spf.{tenant}.example-provider.test
        redirect: _spf.{tenant}.example-provider.test
    # Optional SPF values that are allowed beyond required ones.
    optional:
      mechanisms:
        - ip4:203.0.113.0/24
        - ip6:2001:db8::/32
        - mx
        - ptr
      modifiers: {}

  dkim:
    # DKIM values that must exist for the domain.
    required:
      selectors:
        - selector1
        - selector2
      # DKIM record type: cname (hosted) or txt (self-hosted).
      record_type: cname
      # Template for the expected CNAME target for each selector.
      # The {selector} placeholder is required.
      target_template: "{selector}._domainkey.{tenant}.example-provider.test."
      # Optional mapping of selector -> expected TXT value.
      # Used when record_type is txt (ignored for cname).
      txt_values:
        selector1: "v=DKIM1; k=rsa; p=BASE64KEY"

  dmarc:
    # Required DMARC values.
    required:
      # Default DMARC policy to apply when --dmarc-policy is not provided.
      policy: reject
      # rua URIs that must be present in the DMARC record.
      rua:
        - mailto:dmarc-aggregate@example-provider.test
        - mailto:dmarc-fallback@example-provider.test
        - mailto:postmaster@{domain}
      # ruf URIs that must be present in the DMARC record.
      ruf:
        - mailto:dmarc-forensic@example-provider.test
      # Additional DMARC tags that must match exact values.
      tags:
        adkim: s
        aspf: s
        pct: "100"
    optional:
      rua: []
      ruf: []
    settings:
      # Whether the DMARC record must include a rua tag.
      rua_required: true
      # Whether the DMARC record must include a ruf tag.
      ruf_required: false

  a:
    # Required A records (name -> list of IPv4 addresses).
    required:
      "@":
        - 192.0.2.10
        - 192.0.2.11
    # Optional A records (name -> list of IPv4 addresses).
    optional:
      autodiscover:
        - 192.0.2.12

  aaaa:
    # Required AAAA records (name -> list of IPv6 addresses).
    required:
      "@":
        - 2001:db8::10
    # Optional AAAA records (name -> list of IPv6 addresses).
    optional:
      autodiscover:
        - 2001:db8::12

  ptr:
    # Required PTR records (reverse name -> list of expected hostnames).
    required:
      "10.2.0.192.in-addr.arpa.":
        - mail.{tenant}.example-provider.test.
      "11.2.0.192.in-addr.arpa.":
        - mx1.{tenant}.example-provider.test.
        - mx2.{tenant}.example-provider.test.
    # Optional PTR records (reverse name -> list of expected hostnames).
    optional:
      "12.2.0.192.in-addr.arpa.":
        - autodiscover.{tenant}.example-provider.test.

  cname:
    # Required CNAME records (name -> expected target).
    required:
      lyncdiscover: webdir.example-provider.test.
      sip: sipdir.example-provider.test.
    # Optional CNAME records (name -> expected target).
    optional:
      autoconfig: autoconfig.example-provider.test.

  caa:
    # Required CAA records (name -> list of entries).
    required:
      "@":
        - flags: 0
          tag: issue
          value: ca.example-provider.test
        - flags: 0
          tag: issuewild
          value: ca-wild.example-provider.test
    # Optional CAA records (name -> list of entries).
    optional:
      "mail.{domain}":
        - flags: 0
          tag: iodef
          value: "mailto:security@{domain}"

  srv:
    # Required SRV records (name -> list of entries).
    required:
      _sip._tls:
        - priority: 100
          weight: 1
          port: 443
          target: sipdir.{region}.example-provider.test.
      _sipfederationtls._tcp:
        - priority: 100
          weight: 1
          port: 5061
          target: sipfed.{region}.example-provider.test.
    # Optional SRV records (name -> list of entries).
    optional:
      _autodiscover._tcp:
        - priority: 0
          weight: 0
          port: 443
          target: autodiscover.{region}.example-provider.test.

  tlsa:
    # Required TLSA records (name -> list of entries).
    required:
      _25._tcp.mail:
        - usage: 3
          selector: 1
          matching_type: 1
          certificate_association: "2a3f0b8cc17af4f58b1f99572e7a5e0a79ccf3b8f67b2d61e8d5ac71bc9f4e22"
    # Optional TLSA records (name -> list of entries).
    optional:
      _443._tcp.autodiscover:
        - usage: 3
          selector: 1
          matching_type: 1
          certificate_association: "9f4cf4b2a8e2d76c5d8d3a4e2c1f9b8a7e6d5c4b3a291807f6e5d4c3b2a1908f"

  txt:
    # Required TXT records for any purpose (name -> list of expected values).
    # Names may be relative (appended to the domain) or fully-qualified.
    # "_provider-token" is just an example name; any TXT record name can be used.
    # "@" means the zone apex (the bare domain itself).
    required:
      _provider-token:
        - "provisioning-key=abc123"
        - "activation-hint=def456"
      "@":
        - "v=example-domain-txt; flag=enabled"
      "validation.example-provider.test.":
        - "v=custom-validation; token=xyz"
    # Optional TXT records that can be present if supported (name -> list of expected values).
    optional:
      _provider-optional:
        - "optional-flag=true"
    settings:
      # When true, the provider requires a user-supplied TXT verification record.
      # The user must pass it via --txt-verification. If omitted, the result is WARN (unless skipped).
      verification_required: true
